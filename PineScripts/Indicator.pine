//@version=5
indicator(title = "Trend indicator", shorttitle="CM_EMA TrendBars",overlay=true, timeframe = "", timeframe_gaps = true)
ema1 = input(34, title="EMA UpTrend")
shema = input(true, title="Show EMA Trend is Based On?")

usedEma = ta.ema(close, ema1)

atrPeriod = input.int(10,    "ATR Length", minval = 1)
factor =    input.float(3.83, "Factor",     minval = 0.01, step = 0.01)

[supertrend, direction] = ta.supertrend(factor, atrPeriod)

emaUpColor = ta.crossover(hlc3, usedEma)
emaDownColor = ta.crossunder(hlc3, usedEma)

plotshape(emaUpColor, location=location.belowbar, color=color.green, style=shape.triangleup, size=size.small, title="Uptrend Signal")
plotshape(emaDownColor, location=location.abovebar, color=color.red, style=shape.triangledown, size=size.small, title="Downtrend Signal")

plotshape(direction[1] > direction, location=location.belowbar, color=color.green, style=shape.triangleup, size=size.small, title="Uptrend Signal")
plotshape(direction[1] < direction, location=location.abovebar, color=color.red, style=shape.triangledown, size=size.small, title="Downtrend Signal")
